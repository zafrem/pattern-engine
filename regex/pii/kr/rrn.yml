namespace: kr
description: Korean Resident Registration Number and Alien Registration Number patterns

patterns:
  - id: rrn_01
    location: kr
    category: rrn
    description: Korean Resident Registration Number (주민등록번호)
    pattern: '\b[0-9]{2}[01][0-9][0-3][0-9]-?[1-4][0-9]{6}\b'
    mask: '******-*******'
    examples:
      match:
        - 900101-1234567
        - 900101-2345678
        - '8001011234567'
      nomatch:
        - 900101-5234567
        - 90010-11234567
        - 900101-123456
    policy:
      store_raw: false
      action_on_match: redact
      severity: critical
    metadata:
      note: 'First 6 digits: YYMMDD, 7th digit: gender/century (1-4)'

  - id: alien_registration_01
    location: kr
    category: rrn
    description: Korean Alien Registration Number (외국인등록번호)
    pattern: '\b[0-9]{2}[01][0-9][0-3][0-9]-?[5-8][0-9]{6}\b'
    mask: '******-*******'
    examples:
      match:
        - 900101-5234567
        - 850315-6789012
        - 920228-7123456
        - 880505-8456789
        - '9001015234567'
      nomatch:
        - 900101-1234567
        - 900101-4234567
        - 900101-9234567
        - 90010-15234567
        - 900101-523456
    policy:
      store_raw: false
      action_on_match: redact
      severity: critical
    metadata:
      note: 'First 6 digits: YYMMDD, 7th digit: gender/century for foreigners (5-8)'
