namespace: kr
description: Korean bank account number patterns

patterns:
  - id: bank_account_01
    location: kr
    category: bank
    description: Korean Kookmin Bank account number (국민은행)
    pattern: '\b(?:110|120|150|190|830)[- ]?[0-9]{3}[- ]?[0-9]{6,7}\b'
    verification: korean_bank_account_valid
    mask: '***-***-*******'
    examples:
      match:
        - 110-123-456789
        - 150-999-1234567
        - 190 888 654321
        - 830-001-123456
        - '120123456789'
      nomatch:
        - 999-111-222222
        - 110-12-456789
        - 120-123-45678
    policy:
      store_raw: false
      action_on_match: redact
      severity: critical
    metadata:
      note: 'Kookmin Bank account format: product code (110/120/150/190/830) + 3 digits + 6-7 digits with optional separators'
    priority: 150

  - id: bank_account_02
    location: kr
    category: bank
    description: Korean Shinhan Bank account number (신한은행)
    pattern: '\b(?:110)-?[0-9]{3}-?[0-9]{6,7}\b'
    mask: '***-***-*******'
    examples:
      match:
        - 110-123-456789
        - 110-999-1234567
      nomatch:
        - 120-123-456789
        - 110-12-456789
    policy:
      store_raw: false
      action_on_match: redact
      severity: critical
    metadata:
      note: 'Shinhan Bank account format: 110-XXX-XXXXXX(X) Uses verification to reject timestamps.'
    verification: korean_bank_account_valid
    priority: 150

  - id: bank_account_03
    location: kr
    category: bank
    description: Korean Woori Bank account number (우리은행)
    pattern: '\b(?:1002)-?[0-9]{3}-?[0-9]{6,7}\b'
    mask: '****-***-*******'
    examples:
      match:
        - 1002-123-456789
        - 1002-999-1234567
      nomatch:
        - 1001-123-456789
        - 1002-12-456789
    policy:
      store_raw: false
      action_on_match: redact
      severity: critical
    metadata:
      note: 'Woori Bank account format: 1002-XXX-XXXXXX(X) Uses verification to reject timestamps.'
    verification: korean_bank_account_valid
    priority: 150

  - id: bank_account_04
    location: kr
    category: bank
    description: Korean Hana Bank account number (하나은행)
    pattern: '\b[0-9]{3}-?[0-9]{6}-?[0-9]{4,5}\b'
    verification: generic_number_not_timestamp
    mask: '***-******-*****'
    examples:
      match:
        - 321-987654-3210
        - 999-888777-66655
      nomatch:
        - 12-456789-1234
        - 123-45678-1234
        - '1734567890123'
        - '20231201103045'
    policy:
      store_raw: false
      action_on_match: redact
      severity: critical
    metadata:
      note: 'Hana Bank account format: XXX-XXXXXX-XXXX(X). Uses verification to reject timestamps and datetimes.'
    priority: 150

  - id: bank_account_05
    location: kr
    category: bank
    description: Korean Nonghyup Bank account number (농협은행)
    pattern: '\b(?:301)-?[0-9]{4}-?[0-9]{4}-?[0-9]{2}\b'
    mask: '***-****-****-**'
    examples:
      match:
        - 301-1234-5678-90
        - 301-9999-1111-22
      nomatch:
        - 302-1234-5678-90
        - 301-123-5678-90
    policy:
      store_raw: false
      action_on_match: redact
      severity: critical
    metadata:
      note: 'Nonghyup Bank account format: 301-XXXX-XXXX-XX Uses verification to reject timestamps.'
    verification: korean_bank_account_valid
    priority: 150

  - id: bank_account_06
    location: kr
    category: bank
    description: Korean IBK Industrial Bank account number (IBK기업은행)
    pattern: '\b[0-9]{3}-?[0-9]{6}-?[0-9]{2}-?[0-9]{3}\b'
    verification: generic_number_not_timestamp
    mask: '***-******-**-***'
    examples:
      match:
        - 123-456789-01-234
        - 999-123456-99-888
      nomatch:
        - 12-456789-01-234
        - 123-45678-01-234
        - '20231201103045'
    policy:
      store_raw: false
      action_on_match: redact
      severity: critical
    metadata:
      note: 'IBK Industrial Bank account format: XXX-XXXXXX-XX-XXX. Uses verification to reject timestamps.'
    priority: 150

  - id: bank_account_07
    location: kr
    category: bank
    description: Korean SC First Bank account number (SC제일은행)
    pattern: '\b[0-9]{3}-[0-9]{2}-[0-9]{6}\b'
    verification: generic_number_not_timestamp
    mask: '***-**-******'
    examples:
      match:
        - 123-45-678901
        - 999-88-123456
      nomatch:
        - 12-45-678901
        - 123-4-678901
        - '1734567890123'
    policy:
      store_raw: false
      action_on_match: redact
      severity: critical
    metadata:
      note: 'SC First Bank account format: XXX-XX-XXXXXX (requires hyphens). 11 digits total.'
    priority: 50

  - id: bank_account_08
    location: kr
    category: bank
    description: Korean Citibank account number (한국씨티은행)
    pattern: '\b[0-9]{3}-?[0-9]{5}-?[0-9]{2}-?[0-9]{3}\b'
    verification: generic_number_not_timestamp
    mask: '***-*****-**-***'
    examples:
      match:
        - 123-45678-90-123
        - 999-12345-88-999
      nomatch:
        - 12-45678-90-123
        - 123-4567-90-123
        - '1734567890123'
        - '20231201103045'
    policy:
      store_raw: false
      action_on_match: redact
      severity: critical
    metadata:
      note: 'Citibank Korea account format: XXX-XXXXX-XX-XXX. Uses verification to reject timestamps.'
    priority: 150

  - id: bank_account_09
    location: kr
    category: bank
    description: Korean Busan Bank account number (부산은행)
    pattern: '\b[0-9]{3}-?[0-9]{4}-?[0-9]{4}-?[0-9]{2}\b'
    mask: '***-****-****-**'
    examples:
      match:
        - 123-4567-8901-23
        - 999-1234-5678-90
      nomatch:
        - 12-4567-8901-23
        - 123-456-8901-23
    policy:
      store_raw: false
      action_on_match: redact
      severity: critical
    metadata:
      note: 'Busan Bank account format: XXX-XXXX-XXXX-XX Uses verification to reject timestamps.'
    verification: generic_number_not_timestamp
    priority: 150

  - id: bank_account_10
    location: kr
    category: bank
    description: Korean Daegu Bank account number (대구은행)
    pattern: '\b[0-9]{3}-[0-9]{2}-[0-9]{6}-[0-9]\b'
    mask: '***-**-******-*'
    examples:
      match:
        - 123-45-678901-2
        - 999-88-123456-7
      nomatch:
        - 12-45-678901-2
        - 123-4-678901-2
    policy:
      store_raw: false
      action_on_match: redact
      severity: critical
    metadata:
      note: 'Daegu Bank account format: XXX-XX-XXXXXX-X (requires hyphens). 12 digits total. Higher priority than 11-digit patterns.'
    verification: generic_number_not_timestamp
    priority: 40

  - id: bank_account_11
    location: kr
    category: bank
    description: Korean Gwangju Bank account number (광주은행)
    pattern: '\b[0-9]{3}-[0-9]{3}-[0-9]{6}\b'
    mask: '***-***-******'
    examples:
      match:
        - 123-456-789012
        - 999-123-456789
      nomatch:
        - 12-456-789012
        - 123-45-789012
    policy:
      store_raw: false
      action_on_match: redact
      severity: critical
    metadata:
      note: 'Gwangju Bank account format: XXX-XXX-XXXXXX (requires hyphens). 12 digits total. Higher priority to avoid SSN conflict.'
    verification: generic_number_not_timestamp
    priority: 40

  - id: bank_account_12
    location: kr
    category: bank
    description: Korean Jeonbuk Bank account number (전북은행)
    pattern: '\b[0-9]{3}-[0-9]{2}-[0-9]{6}\b'
    mask: '***-**-******'
    examples:
      match:
        - 123-45-678901
        - 999-88-123456
      nomatch:
        - 12-45-678901
        - 123-4-678901
    policy:
      store_raw: false
      action_on_match: redact
      severity: critical
    metadata:
      note: 'Jeonbuk Bank account format: XXX-XX-XXXXXX (requires hyphens). 11 digits total.'
    verification: generic_number_not_timestamp
    priority: 50

  - id: bank_account_13
    location: kr
    category: bank
    description: Korean Jeju Bank account number (제주은행)
    pattern: '\b[0-9]{2}-?[0-9]{6}-?[0-9]{2}\b'
    verification: generic_number_not_timestamp
    mask: '**-******-**'
    examples:
      match:
        - 89-876543-21
        - 99-888777-66
      nomatch:
        - 1-345678-90
        - 12-34567-90
        - '1734567890'
    policy:
      store_raw: false
      action_on_match: redact
      severity: critical
    metadata:
      note: 'Jeju Bank account format: XX-XXXXXX-XX. Uses verification to reject timestamps.'
    priority: 150

  - id: bank_account_14
    location: kr
    category: bank
    description: Korean Kakao Bank account number (카카오뱅크)
    pattern: '\b3333-?[0-9]{2}-?[0-9]{7}\b'
    mask: '****-**-*******'
    examples:
      match:
        - 3333-12-3456789
        - 3333-99-1234567
      nomatch:
        - 3334-12-3456789
        - 3333-1-3456789
    policy:
      store_raw: false
      action_on_match: redact
      severity: critical
    metadata:
      note: 'Kakao Bank account format: 3333-XX-XXXXXXX Uses verification to reject timestamps.'
    verification: korean_bank_account_valid
    priority: 150

  - id: bank_account_15
    location: kr
    category: bank
    description: Korean digital bank account (K Bank / Toss Bank)
    pattern: '\b100-?[0-9]{3}-?[0-9]{6}\b'
    mask: '***-***-******'
    examples:
      match:
        - 100-123-456789
        - 100-999-123456
      nomatch:
        - 101-123-456789
        - 100-12-456789
    policy:
      store_raw: false
      action_on_match: redact
      severity: critical
    metadata:
      note: 'Digital bank account format: 100-XXX-XXXXXX. Matches both K Bank (케이뱅크) and Toss Bank (토스뱅크) as they share the same format. Uses verification to reject timestamps.'
    verification: korean_bank_account_valid
    priority: 150
