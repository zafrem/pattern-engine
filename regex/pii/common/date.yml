namespace: comm
description: Date patterns (ISO 8601, etc.) for birthday detection

patterns:
  - id: date_iso_01
    location: comm
    category: date_of_birth
    description: ISO 8601 Date (YYYY-MM-DD)
    pattern: '\b(19|20)\d{2}-(0[1-9]|1[0-2])-(0[1-9]|[12]\d|3[01])\b'
    mask: "****-**-**"
    examples:
      match:
        - "1990-01-01"
        - "2005-12-31"
      nomatch:
        - "1899-01-01"
        - "202-01-01"
        - "1990-13-01"
        - "1990-01-32"
    policy:
      store_raw: false
      action_on_match: report
      severity: low # Low by default, boosted by context
    metadata:
      note: "Matches dates from 1900-2099. Requires context (birthday, dob) for high confidence."

  - id: date_slash_01
    location: comm
    category: date_of_birth
    description: Date with slashes (YYYY/MM/DD or MM/DD/YYYY)
    pattern: '\b((19|20)\d{2}/(0[1-9]|1[0-2])/(0[1-9]|[12]\d|3[01])|(0[1-9]|1[0-2])/(0[1-9]|[12]\d|3[01])/(19|20)\d{2})\b'
    mask: "**/**/****"
    examples:
      match:
        - "1990/01/01"
        - "01/01/1990"
      nomatch:
        - "1990/13/01"
    policy:
      store_raw: false
      action_on_match: report
      severity: low
    priority: 150
