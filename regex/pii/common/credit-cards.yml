namespace: comm
description: Credit card number patterns

patterns:
  - id: credit_card_visa_01
    location: comm
    category: credit_card
    description: Visa credit card number
    pattern: '\b4[0-9]{12}(?:[0-9]{3})?\b'
    mask: "****-****-****-****"
    examples:
      match:
        - "4111111111111111"
        - "4012888888881881"
      nomatch:
        - "5111111111111111"
        - "411111111111"
    policy:
      store_raw: false
      action_on_match: redact
      severity: critical

  - id: credit_card_mastercard_01
    location: comm
    category: credit_card
    description: MasterCard credit card number
    pattern: '\b5[1-5][0-9]{14}\b'
    mask: "****-****-****-****"
    examples:
      match:
        - "5500000000000004"
        - "5105105105105100"
      nomatch:
        - "4111111111111111"
        - "550000000000"
    policy:
      store_raw: false
      action_on_match: redact
      severity: critical

  - id: credit_card_amex_01
    location: comm
    category: credit_card
    description: American Express credit card number
    pattern: '\b3[47][0-9]{13}\b'
    mask: "****-******-*****"
    examples:
      match:
        - "378282246310005"
        - "371449635398431"
      nomatch:
        - "4111111111111111"
        - "38123456789012"
    policy:
      store_raw: false
      action_on_match: redact
      severity: critical

  - id: credit_card_discover_01
    location: comm
    category: credit_card
    description: Discover credit card number
    pattern: '\b6(?:011|5[0-9]{2})[0-9]{12}\b'
    mask: "****-****-****-****"
    examples:
      match:
        - "6011111111111117"
        - "6500000000000002"
      nomatch:
        - "4111111111111111"
        - "601111111111"
    policy:
      store_raw: false
      action_on_match: redact
      severity: critical

  - id: credit_card_jcb_01
    location: comm
    category: credit_card
    description: JCB credit card number
    pattern: '\b(?:2131|1800|35\d{3})\d{11}\b'
    mask: "****-****-****-****"
    examples:
      match:
        - "3530111333300000"
        - "3566002020360505"
      nomatch:
        - "4111111111111111"
        - "353011133330"
    policy:
      store_raw: false
      action_on_match: redact
      severity: critical

  - id: credit_card_diners_01
    location: comm
    category: credit_card
    description: Diners Club credit card number
    pattern: '\b3[0689][0-9]{12}\b'
    mask: "****-******-****"
    examples:
      match:
        - "30569309025904"
        - "38520000023237"
      nomatch:
        - "4111111111111111"
        - "305693090259"
    policy:
      store_raw: false
      action_on_match: redact
      severity: critical
