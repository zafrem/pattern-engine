namespace: eu
description: EU VAT (Value Added Tax) numbers for GDPR compliance

patterns:
  - id: vat_germany_01
    location: eu
    category: other
    description: German VAT number (DE + 9 digits)
    pattern: '\bDE\s*[0-9]{9}\b'
    mask: "DE*********"
    examples:
      match:
        - "DE123456789"
        - "DE 123456789"
        - "DE987654321"
      nomatch:
        - "DE12345678"
        - "DE1234567890"
        - "123456789"
    policy:
      store_raw: false
      action_on_match: report
      severity: medium
    metadata:
      note: "German VAT number format. Required for GDPR compliance when processing business data."
    priority: 150

  - id: vat_france_01
    location: eu
    category: other
    description: French VAT number (FR + 2 alphanumeric + 9 digits)
    pattern: '\bFR\s*[A-Z0-9]{2}\s*[0-9]{9}\b'
    mask: "FR***********"
    examples:
      match:
        - "FR12345678901"
        - "FR AB123456789"
        - "FR K7123456789"
      nomatch:
        - "FR123456789"
        - "FR1234567890"
        - "DE123456789"
    policy:
      store_raw: false
      action_on_match: report
      severity: medium
    metadata:
      note: "French VAT number format (TVA intracommunautaire)"
    priority: 150

  - id: vat_italy_01
    location: eu
    category: other
    description: Italian VAT number (IT + 11 digits)
    pattern: '\bIT\s*[0-9]{11}\b'
    mask: "IT***********"
    examples:
      match:
        - "IT12345678901"
        - "IT 12345678901"
        - "IT98765432109"
      nomatch:
        - "IT1234567890"
        - "IT123456789012"
        - "12345678901"
    policy:
      store_raw: false
      action_on_match: report
      severity: medium
    metadata:
      note: "Italian VAT number (Partita IVA)"
    priority: 150

  - id: vat_spain_01
    location: eu
    category: other
    description: Spanish VAT number (ES + letter/digit + 7-8 digits + letter/digit)
    pattern: '\bES\s*[A-Z0-9][0-9]{7,8}[A-Z0-9]\b'
    mask: "ES**********"
    examples:
      match:
        - "ESX12345678"
        - "ES A1234567B"
        - "ES12345678Z"
        - "ES123456789"
      nomatch:
        - "ES1234567"
        - "ES12345678901"
        - "12345678X"
    policy:
      store_raw: false
      action_on_match: report
      severity: medium
    metadata:
      note: "Spanish VAT number (NIF - Número de Identificación Fiscal). Can be all digits or include letters."
    priority: 150

  - id: vat_netherlands_01
    location: eu
    category: other
    description: Dutch VAT number (NL + 9 digits + B + 2 digits)
    pattern: '\bNL\s*[0-9]{9}\s*B\s*[0-9]{2}\b'
    mask: "NL*********B**"
    examples:
      match:
        - "NL123456789B01"
        - "NL 123456789 B 01"
        - "NL999999999B99"
      nomatch:
        - "NL123456789"
        - "NL123456789B1"
        - "NL12345678B01"
    policy:
      store_raw: false
      action_on_match: report
      severity: medium
    metadata:
      note: "Dutch VAT number (BTW-nummer)"
    priority: 150

  - id: vat_belgium_01
    location: eu
    category: other
    description: Belgian VAT number (BE + 10 digits starting with 0 or 1)
    pattern: '\bBE\s*[01][0-9]{9}\b'
    mask: "BE**********"
    examples:
      match:
        - "BE0123456789"
        - "BE 0987654321"
        - "BE1234567890"
      nomatch:
        - "BE2123456789"
        - "BE012345678"
        - "BE01234567890"
    policy:
      store_raw: false
      action_on_match: report
      severity: medium
    metadata:
      note: "Belgian VAT number (BTW/TVA number)"
    priority: 150

  - id: vat_austria_01
    location: eu
    category: other
    description: Austrian VAT number (ATU + 8 digits)
    pattern: '\bATU\s*[0-9]{8}\b'
    mask: "ATU********"
    examples:
      match:
        - "ATU12345678"
        - "ATU 12345678"
        - "ATU99999999"
      nomatch:
        - "ATU1234567"
        - "ATU123456789"
        - "AT12345678"
    policy:
      store_raw: false
      action_on_match: report
      severity: medium
    metadata:
      note: "Austrian VAT number (UID - Umsatzsteuer-Identifikationsnummer)"
    priority: 150

  - id: vat_poland_01
    location: eu
    category: other
    description: Polish VAT number (PL + 10 digits)
    pattern: '\bPL\s*[0-9]{10}\b'
    mask: "PL**********"
    examples:
      match:
        - "PL1234567890"
        - "PL 1234567890"
        - "PL9999999999"
      nomatch:
        - "PL123456789"
        - "PL12345678901"
        - "1234567890"
    policy:
      store_raw: false
      action_on_match: report
      severity: medium
    metadata:
      note: "Polish VAT number (NIP - Numer Identyfikacji Podatkowej)"
    priority: 150

  - id: vat_sweden_01
    location: eu
    category: other
    description: Swedish VAT number (SE + 10 digits + 01)
    pattern: '\bSE\s*[0-9]{10}\s*01\b'
    mask: "SE**********01"
    examples:
      match:
        - "SE123456789001"
        - "SE 1234567890 01"
        - "SE999999999901"
      nomatch:
        - "SE12345678901"
        - "SE123456789002"
        - "SE12345678900"
    policy:
      store_raw: false
      action_on_match: report
      severity: medium
    metadata:
      note: "Swedish VAT number (Momsregistreringsnummer)"
    priority: 150

  - id: vat_ireland_01
    location: eu
    category: other
    description: Irish VAT number (IE + digit/letter + 7 digits + letter OR IE + 7 digits + 2 letters)
    pattern: '\bIE\s*(?:[0-9][A-Z0-9][0-9]{5}[A-Z]|[0-9]{7}[A-Z]{2})\b'
    mask: "IE*********"
    examples:
      match:
        - "IE1234567A"
        - "IE 1A23456B"
        - "IE1234567AB"
      nomatch:
        - "IE12345678"
        - "IE123456"
        - "1234567A"
    policy:
      store_raw: false
      action_on_match: report
      severity: medium
    metadata:
      note: "Irish VAT number (VAT registration number)"
    priority: 150

  - id: vat_portugal_01
    location: eu
    category: other
    description: Portuguese VAT number (PT + 9 digits)
    pattern: '\bPT\s*[0-9]{9}\b'
    mask: "PT*********"
    examples:
      match:
        - "PT123456789"
        - "PT 123456789"
        - "PT999999999"
      nomatch:
        - "PT12345678"
        - "PT1234567890"
        - "123456789"
    policy:
      store_raw: false
      action_on_match: report
      severity: medium
    metadata:
      note: "Portuguese VAT number (NIF - Número de Identificação Fiscal)"
    priority: 150

  - id: vat_greece_01
    location: eu
    category: other
    description: Greek VAT number (EL + 9 digits)
    pattern: '\bEL\s*[0-9]{9}\b'
    mask: "EL*********"
    examples:
      match:
        - "EL123456789"
        - "EL 123456789"
        - "EL999999999"
      nomatch:
        - "EL12345678"
        - "EL1234567890"
        - "GR123456789"
    policy:
      store_raw: false
      action_on_match: report
      severity: medium
    metadata:
      note: "Greek VAT number (ΑΦΜ - Αριθμός Φορολογικού Μητρώου). Uses EL prefix, not GR."
    priority: 150
