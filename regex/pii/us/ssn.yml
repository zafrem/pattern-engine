namespace: us
description: United States Social Security Number patterns

patterns:
  - id: ssn_01
    location: us
    category: ssn
    description: US Social Security Number (SSN)
    pattern: \b[0-9]{3}-?[0-9]{2}-?[0-9]{4}\b
    verification: us_ssn_valid
    mask: "***-**-****"
    examples:
      match:
        - 123-45-6789
        - '123456789'
        - 555-12-3456
      nomatch:
        - 000-12-3456
        - 666-12-3456
        - 900-12-3456
        - 123-00-4567
        - 123-45-0000
        - 12-345-6789
        - 1234-56-789
    policy:
      store_raw: false
      action_on_match: redact
      severity: critical
    metadata:
      note: 'Validates against basic SSA rules: no 000, 666, 900-999 in first group; no 00 in middle; no 0000 in last group'

  - id: itin_01
    location: us
    category: ssn
    description: Individual Taxpayer Identification Number (9XX-XX-XXXX)
    pattern: \b9[0-9]{2}-?[0-9]{2}-?[0-9]{4}\b
    mask: '***-**-****'
    examples:
      match:
        - 900-12-3456
        - '999123456'
      nomatch:
        - 800-12-3456
        - 123-45-6789
    policy:
      store_raw: false
      action_on_match: redact
      severity: critical
